import pandas as pd
from linearmodels import PooledOLS
import numpy as np

panel_data = pd.read_excel('./1-2.xlsx')
panel_data = panel_data.set_index(['国家', '年份'])
model = PooledOLS.from_formula('y ~ x1 + x3 + x4 + x5 + x6 + x7', data=panel_data)

# 拟合面板数据模型
result = model.fit()
x = ['朝鲜', '印度', '印度尼西亚', '日本', '马来西亚', '蒙古', '菲律宾', '新加坡', '韩国', '泰国', '欧洲', '英国', '德国', '法国', '意大利', '荷兰', '葡萄牙',
     '瑞典', '瑞士', '俄罗斯', '北美洲', '加拿大', '美国', '大洋洲', '澳大利亚', '新西兰'
     ]
y = [2019] * 26
pre_data = pd.DataFrame({'国家': x, '年份': y,
                         'x1': [1260, 28300, 11200, 51200, 3651.75, 142.06, 3768.23, 3754.73, 16500, 5440.81, 155854.3,
                                28600, 38900, 27300, 20100, 9101.94, 0.681692505, 5338.8, 7213.69, 16900, 231200, 17400,
                                213800, 16034.35, 13900, 2134.35],
                         'x3': [0.0077, 0.0992, 0.000502, 15.79205028, 1.665278934, 0.00255, 0.1376, 5.0596,
                                0.005922767, 0.222182723, 7.7225, 8.8108, 4.002, 7.7225, 0.004, 3.5518, 1.03,
                                0.730033582, 6.9513, 0.10673042, 5.2029, 5.2029, 6.8985, 4.7956, 4.7956, 4.5468],
                         'x4': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -0.1, -0.2, -0.1, 0.15,
                                0.15, 0.15],
                         'x5': [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360,
                                360, 360, 360, 360, 360, 360, 360, 360, 360],
                         'x6': [93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93,
                                93, 93, 93, 93],
                         'x7': [2540, 2560, 4111.91, 6640, 4651, 5279, 2090, 3264.94, 2500, 1658.2, 7463, 8259.47, 7500,
                                8266.63, 7928, 8000, 9667, 6912, 8000, 6221, 13625, 20078, 13615.18, 1489.7, 8800,
                                10697]

                         })
pre_data = pre_data.set_index(['国家', '年份'])
data = pre_data.apply(lambda x: np.log(x))
print(result.summary)
print(result.predict(pre_data))
